# ============================================
# CONFIGURACIÓN LIVE - SATH v1.8.1 INSTITUCIONAL PRO
# Capital inicial: $100 USD
# Nivel: Institucional Máximo (5 estrellas)
# Filosofía: Menos trades, mayor calidad, R/R superior
# ============================================

# ===== SELECCIÓN DE PROVEEDOR DE IA =====
ai_provider: "deepseek"
ai_model: "deepseek-chat"

# ===== ARQUITECTURA HÍBRIDA =====
ai_use_hybrid_analysis: true
ai_model_fast: "deepseek-chat"
ai_model_deep: "deepseek-reasoner"

# ===== AGENTES ESPECIALIZADOS =====
ai_agents:
  enabled: true
  # v1.8.1 INSTITUCIONAL PRO: Solo operar con volatilidad y volumen suficientes
  min_volatility_percent: 0.40  # Más estricto en LIVE (mayor que paper)
  min_volume_ratio: 0.6  # Volumen alto para confirmar liquidez en LIVE
  # Reintentos para errores de conexión API
  max_retries: 3
  retry_delay_seconds: 2

# ===== SELECCIÓN DE MERCADO =====
market_type: "crypto"

# ===== CONFIGURACIÓN DE TRADING =====
trading:
  # Con $100: Enfoque en pares más líquidos
  symbols:
    - "BTC/USDT"  # Alta liquidez, spreads bajos, estable
    - "ETH/USDT"  # Segunda más líquida, buenas tendencias
    - "SOL/USDT"  # Mayor volatilidad = más oportunidades

  timeframe: "15m"
  scan_interval: 180 # 3 minutos

  # MODO LIVE - TRADING REAL
  mode: "live"

  parallel_analysis: true
  max_parallel_workers: 2

  # Protección contra slippage - MÁS ESTRICTO EN LIVE
  price_verification:
    enabled: true
    max_deviation_percent: 0.2 # Más estricto que paper

  order_execution:
    use_limit_orders: true
    max_slippage_percent: 0.15 # Más conservador en LIVE
    limit_order_timeout: 30
    on_timeout: "cancel"

  advanced_data:
    enabled: true
    order_book: true
    funding_rate: true
    open_interest: true
    correlations: true

# ===== GESTIÓN DE RIESGO - v1.8.1 INSTITUCIONAL PRO ($100) =====
risk_management:
  # v1.8.1: Con $100, arriesgar 1.0% = $1.00 por operación (más conservador en LIVE)
  max_risk_per_trade: 1.0

  # Drawdown máximo diario: 4% = $4 (más estricto en LIVE)
  max_daily_drawdown: 4.0

  # v1.8.1 CRÍTICO: R/R mínimo de 2.0 para expectativa positiva
  min_risk_reward_ratio: 2.0

  use_trailing_stop: true
  trailing_stop_percentage: 2.0

  # CAPITAL LIVE
  initial_capital: 100

  leverage: 1 # Sin apalancamiento - NUNCA usar apalancamiento en capital pequeño

  # v1.8.1 Kelly Criterion INSTITUCIONAL PRO
  # LIVE más conservador que paper
  kelly_criterion:
    enabled: true
    fraction: 0.20 # 1/5 Kelly - conservador para LIVE
    min_confidence: 0.75 # Solo opera con >75% confianza en LIVE (más alto que paper)
    max_risk_cap: 1.5 # Máximo 1.5% en señales muy fuertes (más bajo que paper)

  # v1.8.1 INSTITUCIONAL PRO: ATR-based Stop Loss
  # CRÍTICO: Los institucionales NUNCA usan % fijo
  atr_stops:
    enabled: true
    sl_multiplier: 2.0      # SL a 2x ATR
    tp_multiplier: 4.0      # TP a 4x ATR (R/R 2:1)
    min_distance_percent: 0.5   # Mínimo 0.5%
    max_distance_percent: 4.5   # Máximo 4.5% (más conservador en LIVE)

  # v1.8.1: Session Filter (horarios óptimos de liquidez)
  # CRÍTICO en LIVE - solo opera cuando hay liquidez real
  session_filter:
    enabled: true
    optimal_hours_utc:
      - [7, 16]   # Europa: 7:00-16:00 UTC
      - [13, 22]  # USA: 13:00-22:00 UTC

  # ===== CONTROL DE COMISIONES Y TAMAÑOS MÍNIMOS =====
  fees:
    # Comisión de Binance CON DESCUENTO BNB (25% menos)
    maker_fee_percent: 0.075
    taker_fee_percent: 0.075

  position_sizing:
    # v1.8.1 INSTITUCIONAL PRO: Tamaños que justifiquen el trade
    min_position_usd: 25.0     # Mínimo $25 por posición en LIVE
    min_profit_after_fees_usd: 0.75  # Al menos $0.75 de ganancia neta
    profit_to_fees_ratio: 10.0  # Ganancia esperada debe ser 10x las comisiones (más exigente en LIVE)

  # Mínimos de Binance por par
  exchange_minimums:
    BTC_USDT: 5.0
    ETH_USDT: 5.0
    SOL_USDT: 5.0
    default: 10.0

# ===== GESTIÓN DE POSICIONES v1.8.1 INSTITUCIONAL PRO =====
position_management:
  enabled: true

  protection_mode: "oco"

  oco_settings:
    enabled: true
    sl_limit_buffer_percent: 0.15 # Buffer más pequeño en LIVE

  local_monitoring:
    enabled: true
    check_interval_ms: 300 # Más rápido en LIVE (300ms)

  # Trailing Stop inteligente - v1.8.1 INSTITUCIONAL PRO
  trailing_stop:
    enabled: true
    activation_profit_percent: 3.0  # Activar solo con 3% profit en LIVE (más conservador)
    trail_distance_percent: 1.0     # Trailing 1.0% - más ajustado para LIVE
    min_profit_to_lock: 1.0         # Asegurar mínimo 1.0% profit al activar
    cooldown_seconds: 5             # Más tiempo entre actualizaciones
    min_safety_margin_percent: 0.5  # Mayor margen de seguridad en LIVE

  # Supervisión IA de posiciones
  supervision:
    enabled: true
    check_interval_seconds: 45 # Más frecuente en LIVE
    actions_allowed:
      - "HOLD"
      - "TIGHTEN_SL"
      - "EXTEND_TP"

  # Límites del portfolio - ULTRA CONSERVADOR para $100 LIVE
  portfolio:
    max_concurrent_positions: 1    # Solo 1 posición en LIVE con $100
    max_exposure_percent: 40       # Máximo 40% del capital ($40)
    max_per_symbol_percent: 40

  database:
    path: "data/positions.db"

# ===== ANÁLISIS TÉCNICO - v1.8.1 INSTITUCIONAL PRO =====
technical_analysis:
  # v1.8.1: Mínimo 200 velas para LIVE (análisis robusto)
  min_candles: 200

  indicators:
    rsi:
      enabled: true
      period: 14
      overbought: 70
      oversold: 30
    ema:
      enabled: true
      short_period: 50
      long_period: 200
    bollinger_bands:
      enabled: true
      period: 20
      std_dev: 2
    atr:
      enabled: true
      period: 14
    macd:
      enabled: true
      fast_period: 12
      slow_period: 26
      signal_period: 9

# ===== EXCHANGES =====
exchanges:
  binance:
    enabled: true
    testnet: false # PRODUCCIÓN

# ===== NOTIFICACIONES =====
notifications:
  telegram:
    enabled: true
  email:
    enabled: false

# ===== DATA LOGGING =====
data_logging:
  enabled: true

# ===== WEBSOCKETS =====
websockets:
  enabled: true
  orderbook: true
  ticker: true
  trades: true
  orderbook_depth: 10

# ===== v1.8.1: SIMULACIÓN REALISTA - NO APLICA EN LIVE =====
# paper_simulation: N/A en LIVE

# ===== v1.8.1 INSTITUCIONAL PRO: VALIDACIÓN DE LIQUIDEZ =====
# CRÍTICO en LIVE: Más estricto que paper
liquidity_validation:
  enabled: true
  max_slippage_percent: 0.2        # Muy estricto en LIVE
  min_spread_warning: 0.10         # Advertir si spread > 0.10%
  max_spread_reject: 0.25          # Rechazar si spread > 0.25%
  min_order_book_depth_usd: 1000   # Mínimo $1000 en cada lado

# ===== LOGGING =====
logging:
  level: "INFO"
  file: "logs/trading_bot.log"
  backup_count: 30
  heartbeat_interval: 60

# ===== SEGURIDAD =====
security:
  kill_switch:
    enabled: true
    max_loss_percentage: 4.0 # $4 de pérdida máxima (4% de $100) - MÁS ESTRICTO
    cooldown_period_hours: 24
  api_rate_limit:
    requests_per_minute: 60
    wait_on_limit: true

# ===== v1.8.1 INSTITUCIONAL PRO: MULTI-TIMEFRAME ANALYSIS =====
multi_timeframe:
  enabled: true
  higher_timeframe: "4h"
  medium_timeframe: "1h"
  lower_timeframe: "15m"
  min_alignment_score: 0.80  # 80% mínimo en LIVE (más estricto)
  weights:
    higher: 0.55
    medium: 0.30
    lower: 0.15

# ===== v1.8.1: FILTRO DE CORRELACIÓN =====
correlation_filter:
  enabled: true
  max_correlation: 0.65  # Más estricto en LIVE
  correlations:
    "BTC/USDT,ETH/USDT": 0.85
    "BTC/USDT,SOL/USDT": 0.78
    "ETH/USDT,SOL/USDT": 0.82

# ===== v1.8.1 INSTITUCIONAL PRO: PARÁMETROS ADAPTATIVOS =====
adaptive_parameters:
  enabled: true
  lookback_trades: 30      # Más trades para estadística robusta
  sensitivity: 0.10        # Muy conservador en LIVE - cambios muy graduales
  ranges:
    min_confidence: { min: 0.70, max: 0.90 }  # Siempre alta confianza en LIVE
    max_risk_per_trade: { min: 0.5, max: 1.5 }  # Bajo riesgo en LIVE
    trailing_activation: { min: 2.0, max: 4.0 }

# ===== v1.8.1: PERFORMANCE ATTRIBUTION =====
performance_attribution:
  enabled: true
  log_interval_hours: 24
