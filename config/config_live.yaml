# ============================================
# CONFIGURACION LIVE - SATH v2.2.2 PROFESIONAL
# Capital: $1000 USD (recomendado minimo)
# Nivel: Trader Profesional (15+ aÃ±os experiencia)
# Filosofia: Calidad > Cantidad - Solo setups de alta probabilidad
# v2.2.2: Cooldown + Persistencia SQLite + Filtros calibrados
# ============================================

# ===== SELECCION DE PROVEEDOR DE IA =====
ai_provider: "deepseek"
ai_model: "deepseek-chat"

# ===== ARQUITECTURA HIBRIDA =====
ai_use_hybrid_analysis: true
ai_model_fast: "deepseek-chat"
ai_model_deep: "deepseek-chat"  # Mismo modelo para evitar latencia

# ===== AGENTES ESPECIALIZADOS v2.2.2 =====
ai_agents:
  enabled: true
  # v2.2.2 PROFESIONAL: Filtros calibrados del trade ganador
  min_volatility_percent: 0.5     # Subido de 0.4 - evita mercados muertos
  min_volume_ratio: 1.0           # Subido de 0.6 - volumen confirmado
  ideal_volume_ratio: 1.3         # Ideal para alta probabilidad
  min_adx_trend: 25               # ADX >= 25 para tendencias claras
  max_retries: 2
  retry_delay_seconds: 1

# ===== SELECCION DE MERCADO =====
market_type: "crypto"

# ===== CONFIGURACION DE TRADING =====
trading:
  # 3 pares mas liquidos
  symbols:
    - "BTC/USDT"   # Alta liquidez
    - "ETH/USDT"   # Buenas tendencias (trade ganador fue aqui)
    - "SOL/USDT"   # Mayor volatilidad

  timeframe: "15m"
  scan_interval: 120  # 2 minutos - mas oportunidades

  # MODO LIVE - TRADING REAL
  mode: "live"

  parallel_analysis: true
  max_parallel_workers: 3

  # Proteccion contra slippage
  price_verification:
    enabled: true
    max_deviation_percent: 0.3    # Tolerante pero seguro

  order_execution:
    use_limit_orders: true
    max_slippage_percent: 0.2
    limit_order_timeout: 30
    on_timeout: "cancel"

  advanced_data:
    enabled: true
    order_book: true
    funding_rate: true
    open_interest: true
    correlations: true

# ===== GESTION DE RIESGO v2.2.2 PROFESIONAL =====
risk_management:
  # v2.2.2: Riesgo balanceado para posiciones viables
  max_risk_per_trade: 2.5         # 2.5% = $25 por trade con $1000

  # Drawdown maximo diario
  max_daily_drawdown: 8.0         # 8% = $80

  # R/R minimo - el trade ganador tuvo 2:1 efectivo
  min_risk_reward_ratio: 1.8      # 1.8:1 permite mas oportunidades

  use_trailing_stop: true
  trailing_stop_percentage: 2.0

  # CAPITAL LIVE
  initial_capital: 1000

  leverage: 1  # Sin apalancamiento

  # v2.2.2 Kelly Criterion CALIBRADO
  kelly_criterion:
    enabled: true
    fraction: 0.40                # 40% Kelly - posiciones viables
    min_confidence: 0.65          # 65% confianza minima (trade ganador: 85%)
    max_risk_cap: 3.5             # Hasta 3.5% en senales fuertes

  # v2.2.2 ATR-Based Stops
  atr_stops:
    enabled: true
    sl_multiplier: 1.8            # SL a 1.8x ATR (mas cenido)
    tp_multiplier: 3.6            # TP a 3.6x ATR (R/R 2:1)
    min_distance_percent: 1.0     # Minimo 1%
    max_distance_percent: 5.0     # Maximo 5%

  # v2.2.2: Session Filter HABILITADO en LIVE
  session_filter:
    enabled: true
    optimal_hours_utc:
      - [7, 16]   # Europa: 7:00-16:00 UTC
      - [13, 22]  # USA: 13:00-22:00 UTC

  # ===== CONTROL DE COMISIONES =====
  fees:
    maker_fee_percent: 0.075
    taker_fee_percent: 0.075

  position_sizing:
    min_position_usd: 15.0        # Minimo $15
    min_profit_after_fees_usd: 1.00
    profit_to_fees_ratio: 5.0     # Ganancia 5x comisiones

  exchange_minimums:
    BTC_USDT: 5.0
    ETH_USDT: 5.0
    SOL_USDT: 5.0
    default: 10.0

# ===== GESTION DE POSICIONES v2.2.2 =====
position_management:
  enabled: true
  protection_mode: "oco"
  symbol_cooldown_minutes: 15     # v2.2.2: CRITICO - evita re-entrada prematura

  oco_settings:
    enabled: true
    sl_limit_buffer_percent: 0.2

  local_monitoring:
    enabled: true
    check_interval_ms: 400        # Rapido pero no excesivo

  # v2.2.2 Trailing Stop OPTIMIZADO
  trailing_stop:
    enabled: true
    activation_profit_percent: 1.8  # Activa con 1.8% profit
    trail_distance_percent: 0.8     # Trail 0.8% - ajustado
    min_profit_to_lock: 0.6         # Asegurar 0.6% minimo
    cooldown_seconds: 12
    min_safety_margin_percent: 0.4

  # Supervision IA de posiciones
  supervision:
    enabled: true
    check_interval_seconds: 60
    actions_allowed:
      - "HOLD"
      - "TIGHTEN_SL"
      - "EXTEND_TP"

  # Portfolio para $1000
  portfolio:
    max_concurrent_positions: 2     # 2 posiciones simultaneas
    max_exposure_percent: 65        # 65% = $650 efectivos
    max_per_symbol_percent: 45      # Max 45% por simbolo

  database:
    path: "data/positions.db"

# ===== ANALISIS TECNICO =====
technical_analysis:
  min_candles: 150

  indicators:
    rsi:
      enabled: true
      period: 14
      overbought: 70
      oversold: 30
    ema:
      enabled: true
      short_period: 50
      long_period: 200
    bollinger_bands:
      enabled: true
      period: 20
      std_dev: 2
    atr:
      enabled: true
      period: 14
    macd:
      enabled: true
      fast_period: 12
      slow_period: 26
      signal_period: 9
    adx:
      enabled: true
      period: 14

# ===== EXCHANGES =====
exchanges:
  binance:
    enabled: true
    testnet: false  # PRODUCCION REAL

# ===== NOTIFICACIONES =====
notifications:
  telegram:
    enabled: true
  email:
    enabled: false

# ===== DATA LOGGING =====
data_logging:
  enabled: true

# ===== WEBSOCKETS =====
websockets:
  enabled: true
  orderbook: true
  ticker: true
  trades: true
  orderbook_depth: 10

# ===== VALIDACION DE LIQUIDEZ =====
liquidity_validation:
  enabled: true
  max_slippage_percent: 0.3
  min_spread_warning: 0.15
  max_spread_reject: 0.40
  min_order_book_depth_usd: 500

# ===== LOGGING =====
logging:
  level: "INFO"
  file: "logs/trading_bot.log"
  backup_count: 30
  heartbeat_interval: 60

# ===== SEGURIDAD =====
security:
  kill_switch:
    enabled: true
    max_loss_percentage: 8.0      # $80 perdida maxima
    cooldown_period_hours: 12
  api_rate_limit:
    requests_per_minute: 60
    wait_on_limit: true

# ===== MULTI-TIMEFRAME v2.2.2 =====
multi_timeframe:
  enabled: true
  higher_timeframe: "4h"
  medium_timeframe: "1h"
  lower_timeframe: "15m"
  min_alignment_score: 0.65       # 65% - trade ganador tuvo 100%
  weights:
    higher: 0.45                  # TF alto importante
    medium: 0.35
    lower: 0.20

# ===== FILTRO DE CORRELACION =====
correlation_filter:
  enabled: true
  max_correlation: 0.75
  correlations:
    "BTC/USDT,ETH/USDT": 0.85
    "BTC/USDT,SOL/USDT": 0.78
    "ETH/USDT,SOL/USDT": 0.82

# ===== PARAMETROS ADAPTATIVOS v2.2.2 =====
adaptive_parameters:
  enabled: true
  lookback_trades: 20             # Trades para estadistica
  sensitivity: 0.15               # Ajustes graduales
  default_min_confidence: 0.65    # Confianza base 65%
  ranges:
    min_confidence: { min: 0.60, max: 0.85 }
    max_risk_per_trade: { min: 1.5, max: 3.0 }
    trailing_activation: { min: 1.2, max: 2.5 }

# ===== PERFORMANCE ATTRIBUTION =====
performance_attribution:
  enabled: true
  log_interval_hours: 12
